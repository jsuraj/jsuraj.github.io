---
import NavLink from "./NavLink.astro";
import ThemeToggle from "./ThemeToggle.astro";
import siteConfig from "../data/site-config";

const navLinks = siteConfig.headerNavLinks || [];
---

<nav class="min-h-10 pt-4 pb-12 relative sm:min-h-14 sm:pb-24 md:pt-8">
  {
    navLinks.length > 0 && (
      <div class="w-full max-w-3xl mx-auto relative flex items-center justify-between">
        <div class="flex items-center">
          <button
            class="menu-toggle w-8 h-8 -ml-1 flex items-center justify-center relative z-30 md:hidden"
            aria-label="Open Menu"
            aria-expanded="false"
            aria-controls="menu-items"
          >
            <span class="menu-toggle-icon w-6 h-px relative bg-current" />
          </button>
          <ul id="menu-items" class="menu flex gap-6">
            {navLinks.map((link) => (
              <li class="py-1">
                <NavLink
                  class="text-xl font-serif text-main hover:underline hover:underline-offset-2 hover:decoration-1 md:text-base"
                  href={link.href}
                >
                  {link.text}
                </NavLink>
              </li>
            ))}
          </ul>
        </div>
        <div class="flex items-center gap-4">
          <a
            href="https://x.com/SurajBuilds"
            class="cursor:pointer"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Twitter"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="hover:text-accent transition-colors duration-200"
            >
              <path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z" />
            </svg>
          </a>
          <a
            href="https://www.linkedin.com/in/surajdjagtap/"
            class="cursor:pointer"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="LinkedIn"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="hover:text-accent transition-colors duration-200"
            >
              <>
                <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
                <rect width="4" height="12" x="2" y="9" />
                <circle cx="4" cy="4" r="2" />
              </>
            </svg>
          </a>
          <ThemeToggle />
        </div>
      </div>
    )
  }
</nav>

<style>
  @media (max-width: 767px) {
    .menu {
      @apply flex-col gap-1 absolute -top-2.5 -left-2.5 max-w-64 px-3 pt-16 pb-10 z-20 bg-main border border-dashed border-main invisible opacity-0;
      width: calc(100% + 1.25rem);
    }
    .menu.is-visible {
      @apply visible opacity-100;
      transition: opacity 0.25s cubic-bezier(0.4, 0, 0.2, 1) 0.2s;
    }
    .menu-toggle-icon {
      transition: width 0.1s cubic-bezier(0.4, 0, 0.2, 1) 0.3s;
    }
    .menu-toggle.is-active .menu-toggle-icon {
      @apply w-0;
      transition: width 0.1s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .menu-toggle-icon:before,
    .menu-toggle-icon:after {
      @apply w-6 h-px absolute left-1/2 top-0 origin-center -translate-x-1/2 bg-current;
      content: "";
      transition:
        transform 0.2s cubic-bezier(0.4, 0, 0.2, 1),
        margin 0.2s cubic-bezier(0.4, 0, 0.2, 1) 0.2s;
    }
    .menu-toggle-icon:before {
      @apply -mt-1.5;
    }
    .menu-toggle-icon:after {
      @apply mt-1.5;
    }
    .menu-toggle.is-active .menu-toggle-icon:before,
    .menu-toggle.is-active .menu-toggle-icon:after {
      @apply mt-0;
      transition:
        margin 0.2s cubic-bezier(0.4, 0, 0.2, 1) 0.1s,
        transform 0.2s cubic-bezier(0.4, 0, 0.2, 1) 0.3s;
    }
    .menu-toggle.is-active .menu-toggle-icon:before {
      @apply rotate-45;
    }
    .menu-toggle.is-active .menu-toggle-icon:after {
      @apply -rotate-45;
    }
  }
</style>

<script>
  function menuToggle() {
    const menu = document.querySelector(".menu");
    const menuToggleBtn = document.querySelector(".menu-toggle");
    menuToggleBtn?.addEventListener("click", () => {
      const isMenuExpanded =
        menuToggleBtn.getAttribute("aria-expanded") === "true";
      menuToggleBtn.classList.toggle("is-active");
      menuToggleBtn.setAttribute(
        "aria-expanded",
        isMenuExpanded ? "false" : "true",
      );
      menuToggleBtn.setAttribute(
        "aria-label",
        isMenuExpanded ? "Open Menu" : "Close Menu",
      );
      menu?.classList.toggle("is-visible");
    });
  }
  menuToggle();
  document.addEventListener("astro:after-swap", menuToggle);
</script>
